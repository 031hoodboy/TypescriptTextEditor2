{"ast":null,"code":"/* eslint-disable consistent-return */\nimport objectEach from 'fast-loops/lib/objectEach';\nimport { RULE_TYPE, KEYFRAME_TYPE, FONT_TYPE, STATIC_TYPE, CLEAR_TYPE, generateCSSRule } from 'fela-utils';\nimport getNodeFromCache from './getNodeFromCache';\nimport insertRule from './insertRule';\nexport default function createSubscription(renderer) {\n  var targetDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n  return function (change) {\n    if (change.type === CLEAR_TYPE) {\n      objectEach(renderer.nodes, function (node) {\n        return node.parentNode.removeChild(node);\n      });\n      renderer.nodes = {};\n      renderer.scoreIndex = {};\n      return;\n    }\n\n    var node = getNodeFromCache(change, renderer, targetDocument);\n\n    switch (change.type) {\n      case KEYFRAME_TYPE:\n        if (node.textContent.indexOf(change.keyframe) === -1) {\n          node.textContent += change.keyframe;\n        }\n\n        break;\n\n      case FONT_TYPE:\n        if (node.textContent.indexOf(change.fontFace) === -1) {\n          node.textContent += change.fontFace;\n        }\n\n        break;\n\n      case STATIC_TYPE:\n        var css = change.selector ? generateCSSRule(change.selector, change.css) : change.css;\n\n        if (node.textContent.indexOf(css) === -1) {\n          node.textContent += css;\n        }\n\n        break;\n\n      case RULE_TYPE:\n        insertRule(change, renderer, node);\n        break;\n\n      default:\n        // TODO: warning\n        break;\n    }\n  };\n}","map":{"version":3,"names":["objectEach","RULE_TYPE","KEYFRAME_TYPE","FONT_TYPE","STATIC_TYPE","CLEAR_TYPE","generateCSSRule","getNodeFromCache","insertRule","createSubscription","renderer","targetDocument","arguments","length","undefined","document","change","type","nodes","node","parentNode","removeChild","scoreIndex","textContent","indexOf","keyframe","fontFace","css","selector"],"sources":["/Users/hoodboy/Documents/htdocs/TypescriptTextEditor2/node_modules/fela-dom/es/dom/connection/createSubscription.js"],"sourcesContent":["\n/* eslint-disable consistent-return */\nimport objectEach from 'fast-loops/lib/objectEach';\nimport { RULE_TYPE, KEYFRAME_TYPE, FONT_TYPE, STATIC_TYPE, CLEAR_TYPE, generateCSSRule } from 'fela-utils';\n\nimport getNodeFromCache from './getNodeFromCache';\nimport insertRule from './insertRule';\n\nexport default function createSubscription(renderer) {\n  var targetDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n\n  return function (change) {\n    if (change.type === CLEAR_TYPE) {\n      objectEach(renderer.nodes, function (node) {\n        return node.parentNode.removeChild(node);\n      });\n\n      renderer.nodes = {};\n      renderer.scoreIndex = {};\n      return;\n    }\n\n    var node = getNodeFromCache(change, renderer, targetDocument);\n\n    switch (change.type) {\n      case KEYFRAME_TYPE:\n        if (node.textContent.indexOf(change.keyframe) === -1) {\n          node.textContent += change.keyframe;\n        }\n        break;\n      case FONT_TYPE:\n        if (node.textContent.indexOf(change.fontFace) === -1) {\n          node.textContent += change.fontFace;\n        }\n        break;\n      case STATIC_TYPE:\n        var css = change.selector ? generateCSSRule(change.selector, change.css) : change.css;\n\n        if (node.textContent.indexOf(css) === -1) {\n          node.textContent += css;\n        }\n        break;\n      case RULE_TYPE:\n        insertRule(change, renderer, node);\n        break;\n      default:\n        // TODO: warning\n        break;\n    }\n  };\n}"],"mappings":"AACA;AACA,OAAOA,UAAP,MAAuB,2BAAvB;AACA,SAASC,SAAT,EAAoBC,aAApB,EAAmCC,SAAnC,EAA8CC,WAA9C,EAA2DC,UAA3D,EAAuEC,eAAvE,QAA8F,YAA9F;AAEA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,UAAP,MAAuB,cAAvB;AAEA,eAAe,SAASC,kBAAT,CAA4BC,QAA5B,EAAsC;EACnD,IAAIC,cAAc,GAAGC,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoEG,QAAzF;EAEA,OAAO,UAAUC,MAAV,EAAkB;IACvB,IAAIA,MAAM,CAACC,IAAP,KAAgBZ,UAApB,EAAgC;MAC9BL,UAAU,CAACU,QAAQ,CAACQ,KAAV,EAAiB,UAAUC,IAAV,EAAgB;QACzC,OAAOA,IAAI,CAACC,UAAL,CAAgBC,WAAhB,CAA4BF,IAA5B,CAAP;MACD,CAFS,CAAV;MAIAT,QAAQ,CAACQ,KAAT,GAAiB,EAAjB;MACAR,QAAQ,CAACY,UAAT,GAAsB,EAAtB;MACA;IACD;;IAED,IAAIH,IAAI,GAAGZ,gBAAgB,CAACS,MAAD,EAASN,QAAT,EAAmBC,cAAnB,CAA3B;;IAEA,QAAQK,MAAM,CAACC,IAAf;MACE,KAAKf,aAAL;QACE,IAAIiB,IAAI,CAACI,WAAL,CAAiBC,OAAjB,CAAyBR,MAAM,CAACS,QAAhC,MAA8C,CAAC,CAAnD,EAAsD;UACpDN,IAAI,CAACI,WAAL,IAAoBP,MAAM,CAACS,QAA3B;QACD;;QACD;;MACF,KAAKtB,SAAL;QACE,IAAIgB,IAAI,CAACI,WAAL,CAAiBC,OAAjB,CAAyBR,MAAM,CAACU,QAAhC,MAA8C,CAAC,CAAnD,EAAsD;UACpDP,IAAI,CAACI,WAAL,IAAoBP,MAAM,CAACU,QAA3B;QACD;;QACD;;MACF,KAAKtB,WAAL;QACE,IAAIuB,GAAG,GAAGX,MAAM,CAACY,QAAP,GAAkBtB,eAAe,CAACU,MAAM,CAACY,QAAR,EAAkBZ,MAAM,CAACW,GAAzB,CAAjC,GAAiEX,MAAM,CAACW,GAAlF;;QAEA,IAAIR,IAAI,CAACI,WAAL,CAAiBC,OAAjB,CAAyBG,GAAzB,MAAkC,CAAC,CAAvC,EAA0C;UACxCR,IAAI,CAACI,WAAL,IAAoBI,GAApB;QACD;;QACD;;MACF,KAAK1B,SAAL;QACEO,UAAU,CAACQ,MAAD,EAASN,QAAT,EAAmBS,IAAnB,CAAV;QACA;;MACF;QACE;QACA;IAvBJ;EAyBD,CAtCD;AAuCD"},"metadata":{},"sourceType":"module"}